{% extends 'layouts/bulma-ufs.layout.njk' %}
{% set navType = 'admin' %}
{% set pageTitle = OPPORTUNITY_SETUP_TITLE_TAG + GLOBAL_TAG_TITLE_SUFFIX %}
{% set opportunityName = opportunityName %}
{% set opportunityID = opportunityID %}
{% set fundersList = fundersList %}
{% set isAdminUser = true %}
{% set fundersIsComplete = fundersIsComplete if fundersIsComplete %}
{% set workFlowItemAdded = workFlowItemAdded if workFlowItemAdded %}

{% block content %}

    {% call components.bulmaRow() %}
        {% call components.bulmaColumnAny(size='is-two-thirds') %}
            {{ components.backLink(text=BACK_TO_OPPORTUNITY_DASHBOARD_LINK, url='/prototypes/opportunity-v2/') }}
        {%- endcall %}
    {%- endcall %}

  {% call components.bulmaRow() %}

    {% call components.bulmaColumnAny(size='is-full') %}

    {{ components.captionHeading(text=OPPORTUNITY_SETUP__TITLE, caption=opportunityID + ': ' +opportunityName) }}

    {%- endcall %}

  {%- endcall %}

    {% call components.bulmaRow() %}

        {% call components.bulmaColumnAny(size='is-7') %}

            <section class="section" id="defaultItems">

            <div class="application-item {% if fundersIsComplete %} application-item--complete {% endif %}">
                <div class="application-item__contents govuk-clearfix">

                    <div class="application-item__left">
                        {{ components.link(text="Funders", url='/prototypes/opportunity-v2/funders') }}
                    </div>
                    {% if fundersList %}
                    <div class="application-item__right">
                        <span class="application-item__status">{{ fundersList }}</span>
                    </div>
                    {% else %}
                        <div class="application-item__right">
                            <span class="application-item__status">Incomplete</span>
                        </div>
                    {% endif %}

                </div>
            </div>

            </section>

            <section class="section" id="workflow">

            {{ components.captionHeading(text='Workflow', tag='h2', size='m', extraClass='u-space-t30') }}

            {% if workFlowItemAdded %}
                <div class="application-items">
                    <div class="application-item application-item--workflow u-space-b30">
                        <div class="application-item__contents govuk-clearfix">
                            <div class="application-item__left">
                                {{ components.link(text="Application", url='/prototypes/opportunity-v2/workflow-application') }}
                            </div>
                            <div class="application-item__right">
                                <span class="application-item__control">{{ components.link(text="Remove", url='?removeItem=true') }} </span>
                                <span class="application-item__status">No dates set</span>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}


            {% call components.form(action='/prototypes/opportunity-v2/setup', method='POST',name='addWorkflowItem') %}

                <div class="govuk-form-group ">
                    <label class="govuk-label govuk-label--s" for="select-box">Add workflow item</label>
                    <div class="select-iterator">
                        <select class="govuk-select " id="select-box" name="addWorkflowItem">
                            <option>Select workflow item</option>
                            <option value="application">Application</option>
                        </select>
                        {{ components.button(text='Add', extraClass='govuk-button--secondary') }}
                    </div>
                </div>

            {%- endcall %}

            </section>

            <section class="section" id="completeAction">

                {% call components.formGroup() %}

                    {{ components.button(text=OPPORTUNITY_SETUP_COMPLETE_CTA, extraClass="application-controls__submit")}}

                {%- endcall %}

            </section>

        {%- endcall %}

        {% call components.bulmaColumnAny(size='is-4 is-offset-1') %}

            <div class="govuk-related-items govuk-related-items--flush">

                {{ components.captionHeading(text=opportunityID, tag='h2', size='xs', extraClass='u-space-y5') }}
                <p class="govuk-body-s u-space-b5">
                    {{ opportunityName }}
                </p>

                <ul class="govuk-list u-space-t10">
                    <li>
                        {{ components.link(text='Edit opportunity name', url='/prototypes/opportunity-v2/create?mode=edit', extraClass='govuk-body--s sub-button') }}
                    </li>
                </ul>
            </div>

        {%- endcall %}

    {%- endcall %}

{% endblock %}
