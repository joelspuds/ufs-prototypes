{% extends 'layouts/ufs.layout.njk' %}

{#{% set bodyClass = 'new-gds' %}#}
{% set pageTitle = APPLICATION_OVERVIEW_TITLE_TAG + GLOBAL_TAG_TITLE_SUFFIX %}
{% set showTinyMCEScripts = true %}
{% set storedSpeakerNotes = storedSpeakerNotes if storedSpeakerNotes %}
{% set projectName = projectName if projectName %}
{% set projectDetails = projectDetails if projectDetails %}
{% set hasBeenUpdated = hasBeenUpdated if hasBeenUpdated %}
{% set teamHasBeenUpdated = teamHasBeenUpdated if teamHasBeenUpdated %}
{% set caseHasBeenUpdated = caseHasBeenUpdated if caseHasBeenUpdated %}
{% set capabilityHasBeenUpdated = capabilityHasBeenUpdated if capabilityHasBeenUpdated %}
{% set ethicalHasBeenUpdated = ethicalHasBeenUpdated if ethicalHasBeenUpdated %}
{% set resourcesHasBeenUpdated = resourcesHasBeenUpdated if resourcesHasBeenUpdated %}

{% set projectDetailsIsComplete = projectDetailsIsComplete if projectDetailsIsComplete %}
{% set applicationDetailsIsComplete = applicationDetailsIsComplete if applicationDetailsIsComplete %}
{% set caseForSupportIsComplete = caseForSupportIsComplete if caseForSupportIsComplete %}
{% set resourcesAndCostsIsComplete = resourcesAndCostsIsComplete if resourcesAndCostsIsComplete %}
{% set ethicalIsComplete = ethicalIsComplete if ethicalIsComplete %}

{% block content %}

  {% call components.gridRow() %}

    {% call components.columnFull() %}

        {{ components.captionHeading(text=APPLICATION_OVERVIEW_TITLE_TAG, caption=projectName)}}

    {%- endcall %}

  {%- endcall %}

    {% if hasBeenUpdated %}
        {% call components.gridRow() %}

            {% call components.columnFull() %}

                {{ components.alerts(text='You have successfully updated your application', type='success')}}

            {%- endcall %}

        {%- endcall %}
    {% endif %}

  {% call components.gridRow() %}

    {% call components.columnFull() %}

        <div class="tabs-alt govuk-clearfix">
            <ul class="tabs-alt__list">
                <li class="tabs-alt__item">
                    <a class="tabs-alt__link tabs-alt__link--active" href="#" >Write application</a>
                </li>
                <li class="tabs-alt__item">
                    <a class="tabs-alt__link" href="/prototypes/example-journey/application/view" >Read application</a>
                </li>
            </ul>
        </div>

    {%- endcall %}

  {%- endcall %}

    {% call components.gridRow() %}

        {% call components.columnTwoThirds() %}

          <ul class="application-tasks">
            <li class="application-tasks__item">
                {{ components.link(text='Project details', url='/prototypes/example-journey/application/project-details', extraClass="application-tasks__link govuk-link")}}

                {#{% if projectName != 'Untitled project' %}#}
                {% if projectDetailsIsComplete %}
                    <span class="application-tasks__status application-tasks__status--complete">complete</span>
                {% else %}
                    <span class="application-tasks__status application-tasks__status--incomplete">incomplete</span>
                {% endif %}
            </li>
            <li class="application-tasks__item">
                {{ components.link(text='Application team', url='/prototypes/example-journey/application/application-team', extraClass="application-tasks__link govuk-link")}}

                {#{% if teamHasBeenUpdated %}#}
                {% if applicationDetailsIsComplete %}
                    <span class="application-tasks__status application-tasks__status--complete">complete</span>
                {% else %}
                    <span class="application-tasks__status application-tasks__status--incomplete">incomplete</span>
                {% endif %}

            </li>
          </ul>

            <h2 class="govuk-heading-s">Assessed questions</h2>
            <ul class="application-tasks">
                <li class="application-tasks__item">
                    {{ components.link(text='1. Case for support ', url='/prototypes/example-journey/application/case-for-support', extraClass="application-tasks__link govuk-link")}}

                    {% if caseForSupportIsComplete %}
                        <span class="application-tasks__status application-tasks__status--complete">complete</span>
                    {% else %}
                        <span class="application-tasks__status application-tasks__status--incomplete">incomplete</span>
                    {% endif %}

                </li>
                <li class="application-tasks__item">
                    {{ components.link(text='2. Capability to deliver', url='/prototypes/example-journey/application/capability-to-deliver', extraClass="application-tasks__link govuk-link")}}
                    {% if capabilityHasBeenUpdated %}
                        <span class="application-tasks__status application-tasks__status--complete">complete</span>
                    {% else %}
                        <span class="application-tasks__status application-tasks__status--incomplete">incomplete</span>
                    {% endif %}
                </li>
                <li class="application-tasks__item">
                    {{ components.link(text='3. Resources and cost', url='/prototypes/example-journey/application/resources-and-cost', extraClass="application-tasks__link govuk-link")}}
                    {% if resourcesAndCostsIsComplete %}
                        <span class="application-tasks__status application-tasks__status--complete">complete</span>
                    {% else %}
                        <span class="application-tasks__status application-tasks__status--incomplete">incomplete</span>
                    {% endif %}
                </li>
                <li class="application-tasks__item">
                    {{ components.link(text='4. Ethical and societal issues', url='/prototypes/example-journey/application/ethical-and-societal-issues', extraClass="application-tasks__link govuk-link")}}
                    {% if ethicalIsComplete %}
                        <span class="application-tasks__status application-tasks__status--complete">complete</span>
                    {% else %}
                        <span class="application-tasks__status application-tasks__status--incomplete">incomplete</span>
                    {% endif %}
                </li>
            </ul>

            <div class="application-controls govuk-clearfix">

                {% if progressPercentage == 100 %}
                    {{ components.button(text='Submit application for approval', extraClass="application-controls__submit")}}
                {%  else %}
                    {{ components.button(text='Submit application for approval', extraClass="application-controls__submit", disabled=true)}}
                {% endif %}


                {{ components.link(text='Cancel/withdraw application', url='#', extraClass="application-controls__cancel", disabled=true)}}
            </div>


        {%- endcall %}

        {% call components.columnOneThird(extraClass="padding-left-desktop-30") %}

            <div class="percent-complete">
                <span class="percent-complete__text">{{ progressPercentage }}% complete</span>
                <span class="percent-complete__marker" style="width:{{ progressPercentage }}%">&nbsp;</span>
            </div>

           {# <style>
                .progressBar {
                    width: 300px;
                    /*width: 100%;*/
                    height: 20px;
                    /*border: 1px solid #000;*/
                    position: relative;
                    /*margin-bottom: 5px;*/
                    background-color: #f3f2f1;
                    padding: 4px 0;
                }

                .progressBar .background,
                .progressBar .foreground {
                    width: 300px;
                    /*width: 100%;*/
                    height: 20px;
                    font-size: 16px;
                    text-align: center;
                }

                .progressBar .container {
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 0%;
                    overflow: hidden;
                }

                .progressBar .foreground {
                    background-color: #00703c;
                    color: #FFF;
                    padding: 4px;
                }
            </style>

            {% set progressPercentage = '50' %}

            <div class="u-space-t15">
                <div class = "progressBar">
                    <div class = "background">{{ progressPercentage }}% complete</div>
                    <div class = "container" style="width:{{ progressPercentage }}%">
                        <div class = "foreground">{{ progressPercentage }}% complete</div>
                    </div>
                </div>
            </div>#}

            <style>
                .progress {
                    width: 100%;
                    /*border: 1px solid #000;*/
                    height: 20px;
                    padding:4px 0;
                    position: relative;
                    background-color: #f1f1f1;
                }
                .progress__text {
                    font-size: 14px;
                    position: absolute;
                    left: 1px;
                    top: 1px;
                    padding:4px 0;
                }
                .progress__text--back {
                    text-align: center;
                    color: #000;
                    width: 100%;

                }
                .progress__text--front {
                    text-align: center;
                    color: #c0c0c0;
                    background-color: #1E8400;
                    width: 100%;

                }
                .progress__clipper {
                    position: absolute;
                    left: 1px;
                    top: 1px;
                    padding:4px 0;
                    clip: rect(10px, 290px, 190px, 10px);
                }
            </style>

            <div class="progress">
                <div class="progress__text progress__text--back">0% complete</div>
                <div class="progress__clipper">
                    <div class="progress__text progress__text--front">0% complete</div>
                </div>

            </div>




            <div class="application-data">
                <dl class="application-data__list">
                    <dt class="application-data__key">Application reference:</dt>
                    <dd class="application-data__value">AP00171</dd>

                    <dt class="application-data__key">Application deadline</dt>
                    <dd class="application-data__value">12:00pm Tuesday 30 March 2020</dd>

                    <dt class="application-data__key">Funding opportunity:</dt>
                    <dd class="application-data__value">Biosensors for ribosome inactivating protiens</dd>

                    <dt class="application-data__key">Funder</dt>
                    <dd class="application-data__value">BBSRC</dd>
                </dl>
            </div>



        {%- endcall %}

    {%- endcall %}


{% endblock %}
